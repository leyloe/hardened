#!/usr/sbin/nft -f

# ghcr.io/leyloe/hardened

flush ruleset

table inet filter {
	chain input {
		iifname "lo" accept
		ct state { established, related } accept

		type filter hook input priority filter; policy drop;
	}
	chain output {
		oifname "lo" accept
		ct state { established, related } accept

		oifname "wg0" accept
    	udp dport 51820 accept

		type filter hook forward priority filter; policy drop;
	}
	chain forward {
		type filter hook forward priority filter; policy drop;
	}
}

table ip6 filter {
	chain input {
		type filter hook forward priority filter; policy drop;
	}
	chain forward {
		type filter hook forward priority filter; policy drop;
	}
	chain output {
		type filter hook forward priority filter; policy drop;
	}
}

